<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an Annotated Data Matrix — AnnData • anndata</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an Annotated Data Matrix — AnnData" />
<meta property="og:description" content="AnnData stores a data matrix X together with annotations
of observations obs (obsm, obsp), variables var (varm, varp),
and unstructured annotations uns.
An AnnData object adata can be sliced like a data frame,
for instance adata_subset &amp;lt;- adata[, list_of_variable_names]. AnnData’s
basic structure is similar to R's ExpressionSet.
If setting an h5ad-formatted HDF5 backing file filename,
data remains on the disk but is automatically loaded into memory if needed.
See this blog post for more details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XSL8ZZLBFK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XSL8ZZLBFK');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anndata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dynverse/anndata/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an Annotated Data Matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/dynverse/anndata/blob/master/R/class_anndata.R'><code>R/class_anndata.R</code></a>, <a href='https://github.com/dynverse/anndata/blob/master/R/class_raw.R'><code>R/class_raw.R</code></a></small>
    <div class="hidden name"><code>AnnData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>AnnData</code> stores a data matrix <code>X</code> together with annotations
of observations <code>obs</code> (<code>obsm</code>, <code>obsp</code>), variables <code>var</code> (<code>varm</code>, <code>varp</code>),
and unstructured annotations <code>uns</code>.</p>
<p>An <code>AnnData</code> object <code>adata</code> can be sliced like a data frame,
for instance <code>adata_subset &lt;- adata[, list_of_variable_names]</code>. <code>AnnData</code>’s
basic structure is similar to R's ExpressionSet.</p>
<p>If setting an <code>h5ad</code>-formatted HDF5 backing file <code>filename</code>,
data remains on the disk but is automatically loaded into memory if needed.
See this <a href='http://falexwolf.de/blog/171223_AnnData_indexing_views_HDF5-backing/'>blog post</a> for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='cn'>NULL</span>,
  obs <span class='op'>=</span> <span class='cn'>NULL</span>,
  var <span class='op'>=</span> <span class='cn'>NULL</span>,
  uns <span class='op'>=</span> <span class='cn'>NULL</span>,
  obsm <span class='op'>=</span> <span class='cn'>NULL</span>,
  varm <span class='op'>=</span> <span class='cn'>NULL</span>,
  layers <span class='op'>=</span> <span class='cn'>NULL</span>,
  raw <span class='op'>=</span> <span class='cn'>NULL</span>,
  dtype <span class='op'>=</span> <span class='st'>"float32"</span>,
  shape <span class='op'>=</span> <span class='cn'>NULL</span>,
  filename <span class='op'>=</span> <span class='cn'>NULL</span>,
  filemode <span class='op'>=</span> <span class='cn'>NULL</span>,
  obsp <span class='op'>=</span> <span class='cn'>NULL</span>,
  varp <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>Raw</span><span class='op'>(</span><span class='va'>adata</span>, X <span class='op'>=</span> <span class='cn'>NULL</span>, var <span class='op'>=</span> <span class='cn'>NULL</span>, varm <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>A #observations × #variables data matrix.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>Key-indexed one-dimensional observations annotation of length #observations.</p></td>
    </tr>
    <tr>
      <th>var</th>
      <td><p>Key-indexed one-dimensional variables annotation of length #variables.</p></td>
    </tr>
    <tr>
      <th>uns</th>
      <td><p>Key-indexed unstructured annotation.</p></td>
    </tr>
    <tr>
      <th>obsm</th>
      <td><p>Key-indexed multi-dimensional observations annotation of length #observations. If passing a <code>~numpy.ndarray</code>, it needs to have a structured datatype.</p></td>
    </tr>
    <tr>
      <th>varm</th>
      <td><p>Key-indexed multi-dimensional variables annotation of length #variables.</p></td>
    </tr>
    <tr>
      <th>layers</th>
      <td><p>Key-indexed multi-dimensional arrays aligned to dimensions of <code>X</code>.</p></td>
    </tr>
    <tr>
      <th>raw</th>
      <td><p>Store raw version of <code>X</code> and <code>var</code> as <code>$raw$X</code> and <code>$raw$var</code>.</p></td>
    </tr>
    <tr>
      <th>dtype</th>
      <td><p>Data type used for storage.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Shape list (#observations, #variables). Can only be provided if <code>X</code> is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>Name of backing file. See <a href='https://docs.h5py.org/en/latest/high/file.html#h5py.File'>h5py.File</a>.</p></td>
    </tr>
    <tr>
      <th>filemode</th>
      <td><p>Open mode of backing file. See <a href='https://docs.h5py.org/en/latest/high/file.html#h5py.File'>h5py.File</a>.</p></td>
    </tr>
    <tr>
      <th>obsp</th>
      <td><p>Pairwise annotation of observations, a mutable mapping with array-like values.</p></td>
    </tr>
    <tr>
      <th>varp</th>
      <td><p>Pairwise annotation of observations, a mutable mapping with array-like values.</p></td>
    </tr>
    <tr>
      <th>adata</th>
      <td><p>An AnnData object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>AnnData</code> stores observations (samples) of variables/features in the rows of a matrix.
This is the convention of the modern classics of statistic and machine learning,
the convention of dataframes both in R and Python and the established statistics
and machine learning packages in Python (statsmodels, scikit-learn).</p>
<p>Single dimensional annotations of the observation and variables are stored
in the <code>obs</code> and <code>var</code> attributes as data frames.
This is intended for metrics calculated over their axes.
Multi-dimensional annotations are stored in <code>obsm</code> and <code>varm</code>,
which are aligned to the objects observation and variable dimensions respectively.
Square matrices representing graphs are stored in <code>obsp</code> and <code>varp</code>,
with both of their own dimensions aligned to their associated axis.
Additional measurements across both observations and variables are stored in
<code>layers</code>.</p>
<p>Indexing into an AnnData object can be performed by relative position
with numeric indices,  or by labels.
To avoid ambiguity with numeric indexing into observations or variables,
indexes of the AnnData object are converted to strings by the constructor.</p>
<p>Subsetting an AnnData object by indexing into it will also subset its elements
according to the dimensions they were aligned to.
This means an operation like <code>adata[list_of_obs, ]</code> will also subset <code>obs</code>,
<code>obsm</code>, and <code>layers</code>.</p>
<p>Subsetting an AnnData object returns a view into the original object,
meaning very little additional memory is used upon subsetting.
This is achieved lazily, meaning that the constituent arrays are subset on access.
Copying a view causes an equivalent “real” AnnData object to be generated.
Attempting to modify a view (at any attribute except X) is handled
in a copy-on-modify manner, meaning the object is initialized in place.
Here’s an example</p><pre><span class='va'>batch1</span> <span class='op'>&lt;-</span> <span class='va'>adata</span><span class='op'>[</span><span class='va'>adata</span><span class='op'>$</span><span class='va'>obs</span><span class='op'>[</span><span class='st'>"batch"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"batch1"</span>, <span class='op'>]</span>
<span class='va'>batch1</span><span class='op'>$</span><span class='va'>obs</span><span class='op'>[</span><span class='st'>"value"</span><span class='op'>]</span> <span class='op'>=</span> <span class='fl'>0</span> <span class='co'># This makes batch1 a “real” AnnData object</span>
</pre>

<p>At the end of this snippet: <code>adata</code> was not modified,
and <code>batch1</code> is its own AnnData object with its own data.</p>
<p>Similar to Bioconductor’s <code>ExpressionSet</code> and <code>scipy.sparse</code> matrices,
subsetting an AnnData object retains the dimensionality of its constituent arrays.
Therefore, unlike with the classes exposed by <code>pandas</code>, <code>numpy</code>,
and <code>xarray</code>, there is no concept of a one dimensional AnnData object.
AnnDatas always have two inherent dimensions, <code>obs</code> and <code>var</code>.
Additionally, maintaining the dimensionality of the AnnData object allows for
consistent handling of <code>scipy.sparse</code> matrices and <code>numpy</code> arrays.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='read_h5ad.html'>read_h5ad()</a></code> <code><a href='read_csv.html'>read_csv()</a></code> <code><a href='read_excel.html'>read_excel()</a></code> <code><a href='read_hdf.html'>read_hdf()</a></code> <code><a href='read_loom.html'>read_loom()</a></code> <code><a href='read_mtx.html'>read_mtx()</a></code> <code><a href='read_text.html'>read_text()</a></code> <code><a href='read_umi_tools.html'>read_umi_tools()</a></code> <code><a href='write_h5ad.html'>write_h5ad()</a></code> <code><a href='write_csvs.html'>write_csvs()</a></code> <code><a href='write_loom.html'>write_loom()</a></code></p></div>
    <h2 class="hasAnchor" id="active-bindings"><a class="anchor" href="#active-bindings"></a>Active bindings</h2>

    <p><div class="r6-active-bindings"></p><dl>
<dt><code>X</code></dt><dd><p>Data matrix of shape <code>n_obs</code> × <code>n_vars</code>.</p></dd>

<dt><code>filename</code></dt><dd><p>Name of the backing file.Change to backing mode by setting the filename of a <code>.h5ad</code> file.
<ul>
<li><p>Setting the filename writes the stored data to disk.</p></li>
<li><p>Setting the filename when the filename was previously another name
moves the backing file from the previous file to the new file.
If you want to copy the previous file, use <code>copy(filename='new_filename')</code>.</p></li>
</ul></p></dd>

<dt><code>layers</code></dt><dd><p>A list-like object with values of the same dimensions as <code>X</code>.
Layers in AnnData are inspired by <a href='https://linnarssonlab.org/loompy/apiwalkthrough/index.html#loomlayers'>loompy's layers</a>.Overwrite the layers:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spliced <span class='op'>=</span> <span class='va'>spliced</span>, unspliced <span class='op'>=</span> <span class='va'>unspliced</span><span class='op'>)</span>
</pre>Return the layer named <code>"unspliced"</code>:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"unspliced"</span><span class='op'>]</span>
</pre>Create or replace the <code>"spliced"</code> layer:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"spliced"</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>example_matrix</span>
</pre>Assign the 10th column of layer <code>"spliced"</code> to the variable a:<pre><span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"spliced"</span><span class='op'>]</span><span class='op'>[</span>, <span class='fl'>10</span><span class='op'>]</span>
</pre>Delete the <code>"spliced"</code>:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"spliced"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
</pre>Return layers' names:<pre><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>adata</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>)</span>
</pre></p></dd>

<dt><code>T</code></dt><dd><p>Transpose whole object.Data matrix is transposed, observations and variables are interchanged.Ignores <code>.raw</code>.</p></dd>

<dt><code>is_view</code></dt><dd><p><code>TRUE</code> if object is view of another AnnData object, <code>FALSE</code> otherwise.</p></dd>

<dt><code>isbacked</code></dt><dd><p><code>TRUE</code> if object is backed on disk, <code>FALSE</code> otherwise.</p></dd>

<dt><code>n_obs</code></dt><dd><p>Number of observations.</p></dd>

<dt><code>obs</code></dt><dd><p>One-dimensional annotation of observations (data.frame).</p></dd>

<dt><code>obs_names</code></dt><dd><p>Names of observations.</p></dd>

<dt><code>obsm</code></dt><dd><p>Multi-dimensional annotation of observations (matrix).Stores for each key a two or higher-dimensional matrix with <code>n_obs</code> rows.</p></dd>

<dt><code>obsp</code></dt><dd><p>Pairwise annotation of observations, a mutable mapping with array-like values.Stores for each key a two or higher-dimensional matrix whose first two dimensions are of length <code>n_obs</code>.</p></dd>

<dt><code>n_vars</code></dt><dd><p>Number of variables.</p></dd>

<dt><code>var</code></dt><dd><p>One-dimensional annotation of variables (data.frame).</p></dd>

<dt><code>var_names</code></dt><dd><p>Names of variables.</p></dd>

<dt><code>varm</code></dt><dd><p>Multi-dimensional annotation of variables (matrix).Stores for each key a two or higher-dimensional matrix with <code>n_vars</code> rows.</p></dd>

<dt><code>varp</code></dt><dd><p>Pairwise annotation of variables, a mutable mapping with array-like values.Stores for each key a two or higher-dimensional matrix whose first two dimensions are of length <code>n_vars</code>.</p></dd>

<dt><code>shape</code></dt><dd><p>Shape of data matrix (<code>n_obs</code>, <code>n_vars</code>).</p></dd>

<dt><code>uns</code></dt><dd><p>Unstructured annotation (ordered dictionary).</p></dd>

<dt><code>raw</code></dt><dd><p>Store raw version of <code>X</code> and <code>var</code> as <code>$raw$X</code> and <code>$raw$var</code>.The <code>raw</code> attribute is initialized with the current content of an object
by setting:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>=</span> <span class='va'>adata</span>
</pre>Its content can be deleted:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
</pre>Upon slicing an AnnData object along the obs (row) axis, <code>raw</code> is also
sliced. Slicing an AnnData object along the vars (columns) axis
leaves <code>raw</code> unaffected. Note that you can call:<pre><span class='va'>adata</span><span class='op'>$</span><span class='va'>raw</span><span class='op'>[</span>, <span class='st'>'orig_variable_name'</span><span class='op'>]</span><span class='op'>$</span><span class='va'>X</span>
</pre><code>to retrieve the data associated with a variable that might have been filtered out or "compressed away" in</code>X`.</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>AnnDataR6$new()</code></a></p></li>
<li><p><a href='#method-obs_keys'><code>AnnDataR6$obs_keys()</code></a></p></li>
<li><p><a href='#method-obs_names_make_unique'><code>AnnDataR6$obs_names_make_unique()</code></a></p></li>
<li><p><a href='#method-obsm_keys'><code>AnnDataR6$obsm_keys()</code></a></p></li>
<li><p><a href='#method-var_keys'><code>AnnDataR6$var_keys()</code></a></p></li>
<li><p><a href='#method-var_names_make_unique'><code>AnnDataR6$var_names_make_unique()</code></a></p></li>
<li><p><a href='#method-varm_keys'><code>AnnDataR6$varm_keys()</code></a></p></li>
<li><p><a href='#method-uns_keys'><code>AnnDataR6$uns_keys()</code></a></p></li>
<li><p><a href='#method-chunk_X'><code>AnnDataR6$chunk_X()</code></a></p></li>
<li><p><a href='#method-chunked_X'><code>AnnDataR6$chunked_X()</code></a></p></li>
<li><p><a href='#method-concatenate'><code>AnnDataR6$concatenate()</code></a></p></li>
<li><p><a href='#method-copy'><code>AnnDataR6$copy()</code></a></p></li>
<li><p><a href='#method-rename_categories'><code>AnnDataR6$rename_categories()</code></a></p></li>
<li><p><a href='#method-strings_to_categoricals'><code>AnnDataR6$strings_to_categoricals()</code></a></p></li>
<li><p><a href='#method-to_df'><code>AnnDataR6$to_df()</code></a></p></li>
<li><p><a href='#method-transpose'><code>AnnDataR6$transpose()</code></a></p></li>
<li><p><a href='#method-write_csvs'><code>AnnDataR6$write_csvs()</code></a></p></li>
<li><p><a href='#method-write_h5ad'><code>AnnDataR6$write_h5ad()</code></a></p></li>
<li><p><a href='#method-write_loom'><code>AnnDataR6$write_loom()</code></a></p></li>
<li><p><a href='#method-print'><code>AnnDataR6$print()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Create a new AnnData object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='cn'>NULL</span>,
  obs <span class='op'>=</span> <span class='cn'>NULL</span>,
  var <span class='op'>=</span> <span class='cn'>NULL</span>,
  uns <span class='op'>=</span> <span class='cn'>NULL</span>,
  obsm <span class='op'>=</span> <span class='cn'>NULL</span>,
  varm <span class='op'>=</span> <span class='cn'>NULL</span>,
  layers <span class='op'>=</span> <span class='cn'>NULL</span>,
  raw <span class='op'>=</span> <span class='cn'>NULL</span>,
  dtype <span class='op'>=</span> <span class='st'>"float32"</span>,
  shape <span class='op'>=</span> <span class='cn'>NULL</span>,
  filename <span class='op'>=</span> <span class='cn'>NULL</span>,
  filemode <span class='op'>=</span> <span class='cn'>NULL</span>,
  obsp <span class='op'>=</span> <span class='cn'>NULL</span>,
  varp <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>X</code></dt><dd><p>A #observations × #variables data matrix. A view of the data is used if the data type matches, otherwise, a copy is made.</p></dd>

<dt><code>obs</code></dt><dd><p>Key-indexed one-dimensional observations annotation of length #observations.</p></dd>

<dt><code>var</code></dt><dd><p>Key-indexed one-dimensional variables annotation of length #variables.</p></dd>

<dt><code>uns</code></dt><dd><p>Key-indexed unstructured annotation.</p></dd>

<dt><code>obsm</code></dt><dd><p>Key-indexed multi-dimensional observations annotation of length #observations. If passing a <code>~numpy.ndarray</code>, it needs to have a structured datatype.</p></dd>

<dt><code>varm</code></dt><dd><p>Key-indexed multi-dimensional variables annotation of length #variables. If passing a <code>~numpy.ndarray</code>, it needs to have a structured datatype.</p></dd>

<dt><code>layers</code></dt><dd><p>Key-indexed multi-dimensional arrays aligned to dimensions of <code>X</code>.</p></dd>

<dt><code>raw</code></dt><dd><p>Store raw version of <code>X</code> and <code>var</code> as <code>$raw$X</code> and <code>$raw$var</code>.</p></dd>

<dt><code>dtype</code></dt><dd><p>Data type used for storage.</p></dd>

<dt><code>shape</code></dt><dd><p>Shape list (#observations, #variables). Can only be provided if <code>X</code> is <code>NULL</code>.</p></dd>

<dt><code>filename</code></dt><dd><p>Name of backing file. See <a href='https://docs.h5py.org/en/latest/high/file.html#h5py.File'>h5py.File</a>.</p></dd>

<dt><code>filemode</code></dt><dd><p>Open mode of backing file. See <a href='https://docs.h5py.org/en/latest/high/file.html#h5py.File'>h5py.File</a>.</p></dd>

<dt><code>obsp</code></dt><dd><p>Pairwise annotation of observations, a mutable mapping with array-like values.</p></dd>

<dt><code>varp</code></dt><dd><p>Pairwise annotation of variables, a mutable mapping with array-like values.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
# use AnnData() instead of AnnDataR6$new()
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2"))
)
}
</pre><p></div></p>

<p><hr>
<a id="method-obs_keys"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>obs_keys()</code></h3>
<p>List keys of observation annotation <code>obs</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>obs_keys</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2"))
)
ad$obs_keys()
}
</pre><p></div></p>

<p><hr>
<a id="method-obs_names_make_unique"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>obs_names_make_unique()</code></h3>
<p>Makes the index unique by appending a number string to each duplicate index element: 1, 2, etc.</p>
<p>If a tentative name created by the algorithm already exists in the index, it tries the next integer in the sequence.</p>
<p>The first occurrence of a non-unique value is ignored.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>obs_names_make_unique</span><span class='op'>(</span>join <span class='op'>=</span> <span class='st'>"-"</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>join</code></dt><dd><p>The connecting string between name and integer (default: <code>"-"</code>).</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(rep(1, 6), nrow = 3),
  obs = data.frame(field = c(1, 2, 3))
)
ad$obs_names &lt;- c("a", "a", "b")
ad$obs_names_make_unique()
ad$obs_names
}
</pre><p></div></p>

<p><hr>
<a id="method-obsm_keys"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>obsm_keys()</code></h3>
<p>List keys of observation annotation <code>obsm</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>obsm_keys</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  obsm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  )
)
ad$obs_keys()
}
</pre><p></div></p>

<p><hr>
<a id="method-var_keys"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>var_keys()</code></h3>
<p>List keys of variable annotation <code>var</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>var_keys</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2"))
)
ad$var_keys()
}
</pre><p></div></p>

<p><hr>
<a id="method-var_names_make_unique"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>var_names_make_unique()</code></h3>
<p>Makes the index unique by appending a number string to each duplicate index element: 1, 2, etc.</p>
<p>If a tentative name created by the algorithm already exists in the index, it tries the next integer in the sequence.</p>
<p>The first occurrence of a non-unique value is ignored.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>var_names_make_unique</span><span class='op'>(</span>join <span class='op'>=</span> <span class='st'>"-"</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>join</code></dt><dd><p>The connecting string between name and integer (default: <code>"-"</code>).</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(rep(1, 6), nrow = 2),
  var = data.frame(field = c(1, 2, 3))
)
ad$var_names &lt;- c("a", "a", "b")
ad$var_names_make_unique()
ad$var_names
}
</pre><p></div></p>

<p><hr>
<a id="method-varm_keys"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>varm_keys()</code></h3>
<p>List keys of variable annotation <code>varm</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>varm_keys</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  )
)
ad$varm_keys()
}
</pre><p></div></p>

<p><hr>
<a id="method-uns_keys"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>uns_keys()</code></h3>
<p>List keys of unstructured annotation <code>uns</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>uns_keys</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)
}
</pre><p></div></p>

<p><hr>
<a id="method-chunk_X"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>chunk_X()</code></h3>
<p>Return a chunk of the data matrix <code>X</code> with random or specified indices.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>chunk_X</span><span class='op'>(</span>select <span class='op'>=</span> <span class='fl'>1000L</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>select</code></dt><dd><p>Depending on the values:
<ul>
<li><p>1 integer: A random chunk with select rows will be returned.</p></li>
<li><p>multiple integers: A chunk with these indices will be returned.</p></li>
</ul></p></dd>

<dt><code>replace</code></dt><dd><p>if <code>select</code> is an integer then <code>TRUE</code> means random sampling of indices with replacement,
<code>FALSE</code> without replacement.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(runif(10000), nrow = 50)
)

ad$chunk_X(select = 10L) # 10 random samples
ad$chunk_X(select = 1:3) # first 3 samples
}
</pre><p></div></p>

<p><hr>
<a id="method-chunked_X"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>chunked_X()</code></h3>
<p>Return an iterator over the rows of the data matrix X.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>chunked_X</span><span class='op'>(</span>chunk_size <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>chunk_size</code></dt><dd><p>Row size of a single chunk.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(runif(10000), nrow = 50)
)
ad$chunked_X(10)
}
</pre><p></div></p>

<p><hr>
<a id="method-concatenate"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>concatenate()</code></h3>
<p>Concatenate along the observations axis.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>concatenate</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>Deprecated</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-copy"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>copy()</code></h3>
<p>Full copy, optionally on disk.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span>filename <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>filename</code></dt><dd><p>Path to filename (default: <code>NULL</code>).</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2)
)
ad$copy()
ad$copy("file.h5ad")
}
</pre><p></div></p>

<p><hr>
<a id="method-rename_categories"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>rename_categories()</code></h3>
<p>Rename categories of annotation <code>key</code> in <code>obs</code>, <code>var</code>, and <code>uns</code>.
Only supports passing a list/array-like <code>categories</code> argument.
Besides calling <code>self.obs[key].cat.categories = categories</code> –
similar for <code>var</code> - this also renames categories in unstructured
annotation that uses the categorical annotation <code>key</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>rename_categories</span><span class='op'>(</span><span class='va'>key</span>, <span class='va'>categories</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>key</code></dt><dd><p>Key for observations or variables annotation.</p></dd>

<dt><code>categories</code></dt><dd><p>New categories, the same number as the old categories.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2"))
)
ad$rename_categories("group", c(a = "A", b = "B")) # ??
}
</pre><p></div></p>

<p><hr>
<a id="method-strings_to_categoricals"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>strings_to_categoricals()</code></h3>
<p>Transform string annotations to categoricals.</p>
<p>Only affects string annotations that lead to less categories than the total number of observations.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>strings_to_categoricals</span><span class='op'>(</span>df <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>df</code></dt><dd><p>If <code>df</code> is <code>NULL</code>, modifies both <code>obs</code> and <code>var</code>, otherwise modifies <code>df</code> inplace.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
)
ad$strings_to_categoricals() # ??
}
</pre><p></div></p>

<p><hr>
<a id="method-to_df"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>to_df()</code></h3>
<p>Generate shallow data frame.</p>
<p>The data matrix <code>X</code> is returned as data frame, where <code>obs_names</code> are the rownames, and <code>var_names</code> the columns names.</p>
<p>No annotations are maintained in the returned object.</p>
<p>The data matrix is densified in case it is sparse.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>to_df</span><span class='op'>(</span>layer <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>layer</code></dt><dd><p>Key for layers</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  layers = list(
    spliced = matrix(c(4, 5, 6, 7), nrow = 2),
    unspliced = matrix(c(8, 9, 10, 11), nrow = 2)
  )
)

ad$to_df()
ad$to_df("unspliced")
}
</pre><p></div></p>

<p><hr>
<a id="method-transpose"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>transpose()</code></h3>
<p>transpose Transpose whole object.</p>
<p>Data matrix is transposed, observations and variables are interchanged.</p>
<p>Ignores <code>.raw</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>transpose</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2"))
)

ad$transpose()
}
</pre><p></div></p>

<p><hr>
<a id="method-write_csvs"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='write_csvs.html'>write_csvs()</a></code></h3>
<p>Write annotation to .csv files.</p>
<p>It is not possible to recover the full AnnData from these files. Use <code><a href='write_h5ad.html'>write_h5ad()</a></code> for this.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>write_csvs</span><span class='op'>(</span><span class='va'>dirname</span>, skip_data <span class='op'>=</span> <span class='cn'>TRUE</span>, sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>dirname</code></dt><dd><p>Name of the directory to which to export.</p></dd>

<dt><code>skip_data</code></dt><dd><p>Skip the data matrix <code>X</code>.</p></dd>

<dt><code>sep</code></dt><dd><p>Separator for the data</p></dd>

<dt><code>anndata</code></dt><dd><p>An <code>AnnData()</code> object</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)

ad$to_write_csvs("output")

unlink("output", recursive = TRUE)
}
</pre><p></div></p>

<p><hr>
<a id="method-write_h5ad"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='write_h5ad.html'>write_h5ad()</a></code></h3>
<p>Write .h5ad-formatted hdf5 file.</p>
<p>Generally, if you have sparse data that are stored as a dense matrix, you can
dramatically improve performance and reduce disk space by converting to a csr_matrix:</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>write_h5ad</span><span class='op'>(</span>
  <span class='va'>filename</span>,
  compression <span class='op'>=</span> <span class='cn'>NULL</span>,
  compression_opts <span class='op'>=</span> <span class='cn'>NULL</span>,
  as_dense <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>filename</code></dt><dd><p>Filename of data file. Defaults to backing file.</p></dd>

<dt><code>compression</code></dt><dd><p>See the h5py <a href='http://docs.h5py.org/en/latest/high/dataset.html#dataset-compression'>filter pipeline</a>.
Options are <code>"gzip"</code>, <code>"lzf"</code> or <code>NULL</code>.</p></dd>

<dt><code>compression_opts</code></dt><dd><p>See the h5py <a href='http://docs.h5py.org/en/latest/high/dataset.html#dataset-compression'>filter pipeline</a>.</p></dd>

<dt><code>as_dense</code></dt><dd><p>Sparse in AnnData object to write as dense. Currently only supports <code>"X"</code> and <code>"raw/X"</code>.</p></dd>

<dt><code>anndata</code></dt><dd><p>An <code>AnnData()</code> object</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)

ad$write_h5ad("output.h5ad")

file.remove("output.h5ad")
}
</pre><p></div></p>

<p><hr>
<a id="method-write_loom"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='write_loom.html'>write_loom()</a></code></h3>
<p>Write .loom-formatted hdf5 file.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>write_loom</span><span class='op'>(</span><span class='va'>filename</span>, write_obsm_varm <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>filename</code></dt><dd><p>The filename.</p></dd>

<dt><code>write_obsm_varm</code></dt><dd><p>Whether or not to also write the varm and obsm.</p></dd>

<dt><code>anndata</code></dt><dd><p>An <code>AnnData()</code> object</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)

ad$write_loom("output.loom")

file.remove("output.loom")
}
</pre><p></div></p>

<p><hr>
<a id="method-print"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code></h3>
<p>Print AnnData object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AnnDataR6</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>optional arguments to print method.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  layers = list(
    spliced = matrix(c(4, 5, 6, 7), nrow = 2),
    unspliced = matrix(c(8, 9, 10, 11), nrow = 2)
  ),
  obsm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)

ad$print()
print(ad)
}
</pre><p></div></p>



    <h2 class="hasAnchor" id="active-bindings"><a class="anchor" href="#active-bindings"></a>Active bindings</h2>

    <p><div class="r6-active-bindings"></p><dl>
<dt><code>X</code></dt><dd><p>Data matrix of shape <code>n_obs</code> × <code>n_vars</code>.</p></dd>

<dt><code>n_obs</code></dt><dd><p>Number of observations.</p></dd>

<dt><code>obs_names</code></dt><dd><p>Names of observations.</p></dd>

<dt><code>n_vars</code></dt><dd><p>Number of variables.</p></dd>

<dt><code>var</code></dt><dd><p>One-dimensional annotation of variables (data.frame).</p></dd>

<dt><code>var_names</code></dt><dd><p>Names of variables.</p></dd>

<dt><code>varm</code></dt><dd><p>Multi-dimensional annotation of variables (matrix).Stores for each key a two or higher-dimensional matrix with <code>n_var</code> rows.</p></dd>

<dt><code>shape</code></dt><dd><p>Shape of data matrix (<code>n_obs</code>, <code>n_vars</code>).</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>RawR6$new()</code></a></p></li>
<li><p><a href='#method-copy'><code>RawR6$copy()</code></a></p></li>
<li><p><a href='#method-to_adata'><code>RawR6$to_adata()</code></a></p></li>
<li><p><a href='#method-print'><code>RawR6$print()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Create a new Raw object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>RawR6</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>adata</span>, X <span class='op'>=</span> <span class='cn'>NULL</span>, var <span class='op'>=</span> <span class='cn'>NULL</span>, varm <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>adata</code></dt><dd><p>An AnnData object.</p></dd>

<dt><code>X</code></dt><dd><p>A #observations × #variables data matrix.</p></dd>

<dt><code>var</code></dt><dd><p>Key-indexed one-dimensional variables annotation of length #variables.</p></dd>

<dt><code>varm</code></dt><dd><p>Key-indexed multi-dimensional variables annotation of length #variables.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
# use Raw() instead of RawR6$new()
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2"))
)

ad$raw &lt;- ad

ad$raw[]
}
</pre><p></div></p>

<p><hr>
<a id="method-copy"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>copy()</code></h3>
<p>Full copy, optionally on disk.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>RawR6</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>filename</code></dt><dd><p>Path to filename (default: <code>NULL</code>).</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2)
)
ad$copy()
ad$copy("file.h5ad")
}
</pre><p></div></p>

<p><hr>
<a id="method-to_adata"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>to_adata()</code></h3>
<p>Create a full AnnData object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>RawR6</span><span class='op'>$</span><span class='fu'>to_adata</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  layers = list(
    spliced = matrix(c(4, 5, 6, 7), nrow = 2),
    unspliced = matrix(c(8, 9, 10, 11), nrow = 2)
  )
)
ad$raw &lt;- ad

ad$raw$to_adata()
}
</pre><p></div></p>

<p><hr>
<a id="method-print"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code></h3>
<p>Print Raw object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>RawR6</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>optional arguments to print method.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Examples</h4>
<p><div class="r example copy"></p><pre>\dontrun{
ad &lt;- AnnData(
  X = matrix(c(0, 1, 2, 3), nrow = 2),
  obs = data.frame(group = c("a", "b"), row.names = c("s1", "s2")),
  var = data.frame(type = c(1L, 2L), row.names = c("var1", "var2")),
  layers = list(
    spliced = matrix(c(4, 5, 6, 7), nrow = 2),
    unspliced = matrix(c(8, 9, 10, 11), nrow = 2)
  ),
  obsm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  varm = list(
    ones = matrix(rep(1L, 10), nrow = 2),
    rand = matrix(rnorm(6), nrow = 2),
    zeros = matrix(rep(0L, 10), nrow = 2)
  ),
  uns = list(a = 1, b = 2, c = list(c.a = 3, c.b = 4))
)
ad$raw &lt;- ad

library(reticulate)
sc &lt;- import("scanpy")
sc$pp$normalize_per_cell(ad)

ad[]
ad$raw[]

ad$print()
print(ad)
}
</pre><p></div></p>




    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  obsm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>X</span> <span class='op'>&lt;-</span> <span class='va'>value</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>X</span>

<span class='va'>ad</span><span class='op'>$</span><span class='va'>layers</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"spliced"</span><span class='op'>]</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>layers</span><span class='op'>[</span><span class='st'>"test"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>value</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>layers</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>to_df</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>uns</span>

<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>ad</span>, layer <span class='op'>=</span> <span class='st'>"unspliced"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$new`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># use AnnData() instead of AnnDataR6$new()</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$obs_keys`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>obs_keys</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$obs_names_make_unique`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>field <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>obs_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>obs_names_make_unique</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>obs_names</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$obsm_keys`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  obsm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>obs_keys</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$var_keys`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>var_keys</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$var_names_make_unique`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>field <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>var_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>var_names_make_unique</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>var_names</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$varm_keys`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>varm_keys</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$uns_keys`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$chunk_X`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>10000</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>chunk_X</span><span class='op'>(</span>select <span class='op'>=</span> <span class='fl'>10L</span><span class='op'>)</span> <span class='co'># 10 random samples</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>chunk_X</span><span class='op'>(</span>select <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='co'># first 3 samples</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$chunked_X`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>10000</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>chunked_X</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$copy`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span><span class='st'>"file.h5ad"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$rename_categories`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>rename_categories</span><span class='op'>(</span><span class='st'>"group"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='st'>"A"</span>, b <span class='op'>=</span> <span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># ??</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$strings_to_categoricals`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>strings_to_categoricals</span><span class='op'>(</span><span class='op'>)</span> <span class='co'># ??</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$to_df`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>to_df</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>to_df</span><span class='op'>(</span><span class='st'>"unspliced"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$transpose`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>transpose</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$write_csvs`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>to_write_csvs</span><span class='op'>(</span><span class='st'>"output"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='st'>"output"</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$write_h5ad`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>write_h5ad</span><span class='op'>(</span><span class='st'>"output.h5ad"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='st'>"output.h5ad"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$write_loom`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>write_loom</span><span class='op'>(</span><span class='st'>"output.loom"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='st'>"output.loom"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `AnnDataR6$print`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  obsm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  obsm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>&lt;-</span> <span class='va'>ad</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/reticulate'>reticulate</a></span><span class='op'>)</span>
<span class='va'>sc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/reticulate/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"scanpy"</span><span class='op'>)</span>
<span class='va'>sc</span><span class='op'>$</span><span class='va'>pp</span><span class='op'>$</span><span class='fu'>normalize_per_cell</span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>

<span class='va'>ad</span><span class='op'>[</span><span class='op'>]</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span><span class='op'>[</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `RawR6$new`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># use Raw() instead of RawR6$new()</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>&lt;-</span> <span class='va'>ad</span>

<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span><span class='op'>[</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `RawR6$copy`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='fu'>copy</span><span class='op'>(</span><span class='st'>"file.h5ad"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `RawR6$to_adata`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>&lt;-</span> <span class='va'>ad</span>

<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span><span class='op'>$</span><span class='fu'>to_adata</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `RawR6$print`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>ad</span> <span class='op'>&lt;-</span> <span class='fu'>AnnData</span><span class='op'>(</span>
  X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"s1"</span>, <span class='st'>"s2"</span><span class='op'>)</span><span class='op'>)</span>,
  var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"var1"</span>, <span class='st'>"var2"</span><span class='op'>)</span><span class='op'>)</span>,
  layers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    spliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    unspliced <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span>, <span class='fl'>11</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  obsm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  varm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    ones <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    rand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
    zeros <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>10</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>)</span>,
  uns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span>, c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>c.a <span class='op'>=</span> <span class='fl'>3</span>, c.b <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span> <span class='op'>&lt;-</span> <span class='va'>ad</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/reticulate'>reticulate</a></span><span class='op'>)</span>
<span class='va'>sc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/reticulate/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"scanpy"</span><span class='op'>)</span>
<span class='va'>sc</span><span class='op'>$</span><span class='va'>pp</span><span class='op'>$</span><span class='fu'>normalize_per_cell</span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>

<span class='va'>ad</span><span class='op'>[</span><span class='op'>]</span>
<span class='va'>ad</span><span class='op'>$</span><span class='va'>raw</span><span class='op'>[</span><span class='op'>]</span>

<span class='va'>ad</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ad</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Philipp Angerer, Alex Wolf, Isaac Virshup, Sergei Rybakov, Robrecht Cannoodt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


